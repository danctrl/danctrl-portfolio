---
const titles = [
    "DevOps Engineer",
    "System Administrator",
    "Cybersecurity Enthusiast",
    "AI Explorer",
];
---

<section id="hero" class="relative flex min-h-screen items-center overflow-hidden pt-16">
    <!-- Gradient background -->
    <div class="hero-gradient absolute inset-0 -z-10" aria-hidden="true"></div>

    <!-- Floating geometric shapes (dark mode only, interactive) -->
    <div
        id="shapes-container"
        class="pointer-events-none absolute inset-0 z-10 hidden overflow-hidden dark:block"
        aria-hidden="true"
    >
        <!-- Circle -->
        <div
            class="floating-shape draggable-shape pointer-events-auto absolute top-[15%] left-[10%] h-[60px] w-[60px] cursor-grab rounded-full border border-emerald-500/20"
            style="animation-duration: 10s;"
        >
        </div>
        <!-- Triangle -->
        <svg
            class="floating-shape draggable-shape pointer-events-auto absolute top-[60%] right-[12%] h-[50px] w-[50px] cursor-grab text-emerald-500/15"
            style="animation-duration: 8s; animation-delay: -3s;"
            viewBox="0 0 50 50"
            fill="currentColor"
            ><polygon points="25,5 45,45 5,45"></polygon></svg
        >
        <!-- Hexagon -->
        <svg
            class="floating-shape draggable-shape pointer-events-auto absolute top-[30%] right-[25%] h-[40px] w-[40px] cursor-grab text-emerald-500/10"
            style="animation-duration: 12s; animation-delay: -5s;"
            viewBox="0 0 100 100"
            fill="currentColor"
            ><polygon points="50,3 97,25 97,75 50,97 3,75 3,25"></polygon></svg
        >
        <!-- Small circle -->
        <div
            class="floating-shape draggable-shape pointer-events-auto absolute bottom-[20%] left-[30%] h-[30px] w-[30px] cursor-grab rounded-full bg-emerald-500/10"
            style="animation-duration: 13s; animation-delay: -4s;"
        >
        </div>
    </div>

    <div class="mx-auto max-w-5xl px-6 py-24 text-center md:text-left">
        <!-- Status indicator -->
        <div
            class="glass mb-8 inline-flex items-center gap-2 rounded-full px-4 py-1.5 text-sm text-gray-600 dark:text-gray-400"
        >
            <span class="relative flex h-2 w-2">
                <span
                    class="absolute inline-flex h-full w-full animate-ping rounded-full bg-emerald-400 opacity-75"
                ></span>
                <span
                    class="relative inline-flex h-2 w-2 rounded-full bg-emerald-500"
                ></span>
            </span>
            Open for opportunities
        </div>

        <!-- Headline -->
        <h1
            class="mb-6 font-mono text-3xl font-bold leading-tight tracking-tight text-[#1a1a1a] sm:text-4xl lg:text-5xl dark:text-white"
        >
            Documenting the journey<br />of building infrastructure
        </h1>

        <!-- Typing subtitle -->
        <div
            class="mb-4 flex h-8 items-center justify-center text-lg text-gray-500 sm:text-xl md:justify-start dark:text-gray-400"
        >
            <span id="typing-text" aria-label={titles.join(", ")}></span><span
                class="typing-cursor text-emerald-500">|</span
            >
        </div>

        <!-- Description -->
        <p
            class="mx-auto mb-10 max-w-2xl text-lg text-gray-500 md:mx-0 dark:text-gray-400"
        >
            DevOps enthusiast based in Berlin, bridging technical systems with
            business understanding.
        </p>

        <!-- CTAs -->
        <div
            class="flex flex-col items-center justify-center gap-4 sm:flex-row md:justify-start"
        >
            <a
                href="#bio"
                class="btn-primary inline-flex h-[44px] items-center gap-2 rounded-lg px-6 text-sm"
            >
                About me
                <svg class="h-4 w-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 8l4 4m0 0l-4 4m4-4H3" />
                </svg>
            </a>
            <a
                href="#projects"
                class="btn-secondary inline-flex h-[44px] items-center rounded-lg px-6 text-sm font-semibold"
            >
                Browse Projects
            </a>
        </div>
    </div>
</section>

<script define:vars={{ titles }}>
    const el = document.getElementById("typing-text");
    if (el) {
        let titleIndex = 0;
        let charIndex = 0;
        let deleting = false;
        const typeSpeed = 80;
        const deleteSpeed = 40;
        const pauseAfterType = 2000;
        const pauseAfterDelete = 500;

        function tick() {
            const current = titles[titleIndex];
            if (!deleting) {
                el.textContent = current.slice(0, charIndex + 1);
                charIndex++;
                if (charIndex === current.length) {
                    deleting = true;
                    setTimeout(tick, pauseAfterType);
                    return;
                }
                setTimeout(tick, typeSpeed);
            } else {
                el.textContent = current.slice(0, charIndex - 1);
                charIndex--;
                if (charIndex === 0) {
                    deleting = false;
                    titleIndex = (titleIndex + 1) % titles.length;
                    setTimeout(tick, pauseAfterDelete);
                    return;
                }
                setTimeout(tick, deleteSpeed);
            }
        }
        tick();
    }
</script>

<script>
    // Interactive drag & throw for floating shapes
    document.querySelectorAll(".draggable-shape").forEach((shape) => {
        let isDragging = false;
        let offsetX = 0;
        let offsetY = 0;
        let velX = 0;
        let velY = 0;
        let lastX = 0;
        let lastY = 0;
        let lastTime = 0;
        let animFrame = 0;

        shape.addEventListener("mousedown", (e) => {
            isDragging = true;
            shape.style.animationPlayState = "paused";
            shape.style.cursor = "grabbing";
            const rect = shape.getBoundingClientRect();
            offsetX = e.clientX - rect.left - rect.width / 2;
            offsetY = e.clientY - rect.top - rect.height / 2;
            lastX = e.clientX;
            lastY = e.clientY;
            lastTime = Date.now();
            velX = 0;
            velY = 0;
            cancelAnimationFrame(animFrame);
            e.preventDefault();
        });

        document.addEventListener("mousemove", (e) => {
            if (!isDragging) return;
            const container = shape.parentElement;
            const cRect = container.getBoundingClientRect();
            const x = e.clientX - cRect.left - offsetX - shape.offsetWidth / 2;
            const y = e.clientY - cRect.top - offsetY - shape.offsetHeight / 2;
            shape.style.left = x + "px";
            shape.style.top = y + "px";
            shape.style.right = "auto";
            shape.style.bottom = "auto";

            const now = Date.now();
            const dt = now - lastTime || 1;
            velX = (e.clientX - lastX) / dt * 16;
            velY = (e.clientY - lastY) / dt * 16;
            lastX = e.clientX;
            lastY = e.clientY;
            lastTime = now;
        });

        document.addEventListener("mouseup", () => {
            if (!isDragging) return;
            isDragging = false;
            shape.style.cursor = "grab";

            // Throw with momentum, then drift back to float animation
            const friction = 0.95;
            function drift() {
                if (Math.abs(velX) < 0.1 && Math.abs(velY) < 0.1) {
                    shape.style.animationPlayState = "running";
                    return;
                }
                const currentLeft = parseFloat(shape.style.left) || 0;
                const currentTop = parseFloat(shape.style.top) || 0;
                shape.style.left = (currentLeft + velX) + "px";
                shape.style.top = (currentTop + velY) + "px";
                velX *= friction;
                velY *= friction;
                animFrame = requestAnimationFrame(drift);
            }
            drift();
        });
    });
</script>
